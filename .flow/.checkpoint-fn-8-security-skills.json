{
  "created_at": "2026-02-12T21:33:17.453467Z",
  "epic": {
    "data": {
      "branch_name": "fn-8-security-skills",
      "completion_review_status": "unknown",
      "completion_reviewed_at": null,
      "created_at": "2026-02-11T22:23:17.848507Z",
      "default_impl": null,
      "default_review": null,
      "default_sync": null,
      "depends_on_epics": [
        "fn-2-plugin-skeleton-and-infrastructure"
      ],
      "id": "fn-8-security-skills",
      "next_task": 1,
      "plan_review_status": "ship",
      "plan_reviewed_at": "2026-02-12T20:54:51.121730Z",
      "spec_path": ".flow/specs/fn-8-security-skills.md",
      "status": "open",
      "title": "Security Skills",
      "updated_at": "2026-02-12T20:54:51.121864Z"
    },
    "spec": "# fn-8: Security Skills\n\n## Overview\nDelivers security skills covering OWASP top 10 for .NET, secrets management, modern cryptography (including post-quantum), and a security reviewer agent.\n\n## Scope Boundary\n**In scope:** Security guidance for .NET applications: OWASP vulnerability mitigation, secrets management patterns, cryptographic best practices, and automated security review.\n\n**Out of scope / Owned by other skills:**\n- Authentication/authorization implementation (ASP.NET Core Identity, OAuth) -- owned by fn-12\n- Cloud-specific security services (Azure Key Vault, AWS Secrets Manager details) -- cloud epics\n- Network security and firewall configuration -- infrastructure concerns\n\nThe boundary is: fn-8 skills cover \"how to write secure .NET code\"; cloud-specific and auth implementation details belong to other epics.\n\n## Skills\nEach skill lives at `skills/security/<skill-name>/SKILL.md` (folder-per-skill convention).\n\n- `dotnet-security-owasp` -- OWASP Top 10 for .NET with mitigation patterns for each category:\n  1. A01 Broken Access Control\n  2. A02 Cryptographic Failures\n  3. A03 Injection (SQL, command, LDAP, XSS)\n  4. A04 Insecure Design\n  5. A05 Security Misconfiguration\n  6. A06 Vulnerable and Outdated Components\n  7. A07 Identification and Authentication Failures\n  8. A08 Software and Data Integrity Failures\n  9. A09 Security Logging and Monitoring Failures\n  10. A10 Server-Side Request Forgery (SSRF)\n- `dotnet-secrets-management` -- Cloud-agnostic first: user secrets for local development, environment variables for production, IConfiguration binding patterns, secret rotation guidance; mentions managed identity as a production best practice without deep cloud-provider specifics; anti-patterns (secrets in source, appsettings.json, hardcoded connection strings)\n- `dotnet-cryptography` -- Modern .NET cryptography: hashing (SHA-256/384/512), symmetric encryption (AES-GCM), asymmetric (RSA, ECDSA), key derivation (PBKDF2, Argon2); post-quantum algorithms (ML-KEM, ML-DSA, SLH-DSA) for .NET 10+ with fallback strategy for earlier TFMs; interoperability caveats\n\n## Deprecated Pattern Ownership\nThe `dotnet-security-owasp` skill is the **canonical owner** of deprecated security pattern warnings (CAS, APTCA, .NET Remoting, DCOM, BinaryFormatter). Other security skills cross-reference OWASP for the full list rather than duplicating it. The crypto skill warns only about deprecated cryptographic APIs (MD5, SHA1, DES, RC2) relevant to its domain.\n\n## Agent\n- `dotnet-security-reviewer` -- Agent at `agents/dotnet-security-reviewer.md`. Analyzes code for security vulnerabilities using OWASP compliance patterns. Read-only analysis agent (no code modification).\n\n## Minimum Supported Versions\n- .NET: 8.0+ (LTS baseline); note when features require 10.0+ (post-quantum crypto)\n- ASP.NET Core: 8.0+ for security middleware and anti-forgery patterns\n\n## Cross-Reference Matrix\nEach skill MUST include outbound `[skill:...]` cross-references as follows:\n\n| Skill | Required Outbound Refs |\n|---|---|\n| `dotnet-security-owasp` | `dotnet-secrets-management`, `dotnet-cryptography`, `dotnet-csharp-coding-standards` |\n| `dotnet-secrets-management` | `dotnet-security-owasp`, `dotnet-csharp-configuration` |\n| `dotnet-cryptography` | `dotnet-security-owasp`, `dotnet-secrets-management` |\n\nThe `dotnet-security-reviewer` agent preloads all 3 security skills plus `dotnet-advisor`.\n\n## Quick Commands\n```bash\n# Smoke test: verify OWASP skill covers top 10\ngrep -c \"^##.*A0[1-9]\\|^##.*A10\" skills/security/dotnet-security-owasp/SKILL.md  # expect 10\n\n# Validate post-quantum crypto coverage\ngrep -i \"ML-KEM\\|ML-DSA\\|SLH-DSA\" skills/security/dotnet-cryptography/SKILL.md\n\n# Verify security reviewer agent exists\ntest -f agents/dotnet-security-reviewer.md && echo \"OK\" || echo \"MISSING\"\n\n# Verify all 3 skills registered in plugin.json\ngrep -c \"skills/security/\" .claude-plugin/plugin.json  # expect 3\n\n# Verify agent registered in plugin.json\ngrep -c \"dotnet-security-reviewer\" .claude-plugin/plugin.json  # expect 1\n\n# Verify deprecated patterns in OWASP skill (canonical owner)\ngrep -i \"CAS\\|APTCA\\|\\.NET Remoting\\|DCOM\\|BinaryFormatter\" skills/security/dotnet-security-owasp/SKILL.md\n\n# Verify cross-references per matrix\ngrep \"skill:dotnet-secrets-management\" skills/security/dotnet-security-owasp/SKILL.md\ngrep \"skill:dotnet-cryptography\" skills/security/dotnet-security-owasp/SKILL.md\ngrep \"skill:dotnet-csharp-coding-standards\" skills/security/dotnet-security-owasp/SKILL.md\ngrep \"skill:dotnet-security-owasp\" skills/security/dotnet-secrets-management/SKILL.md\ngrep \"skill:dotnet-csharp-configuration\" skills/security/dotnet-secrets-management/SKILL.md\ngrep \"skill:dotnet-security-owasp\" skills/security/dotnet-cryptography/SKILL.md\ngrep \"skill:dotnet-secrets-management\" skills/security/dotnet-cryptography/SKILL.md\n```\n\n## Acceptance Criteria\n1. All 3 skills written at `skills/security/<name>/SKILL.md` with required frontmatter (`name`, `description`)\n2. Each skill has: description, scope boundary, prerequisites, cross-references, \u22652 practical code examples, gotchas/pitfalls section, references\n3. OWASP skill covers all 10 OWASP Top 10 (2021) categories with .NET-specific mitigation patterns for each\n4. Secrets management skill documents user secrets (local dev), environment variables (production), IConfiguration binding, secret rotation, managed identity mention, and anti-patterns (no secrets in source/appsettings)\n5. Cryptography skill covers modern algorithms with TFM-aware guidance: post-quantum (ML-KEM, ML-DSA, SLH-DSA) for .NET 10+, fallback strategy for .NET 8/9, interoperability caveats\n6. OWASP skill (canonical owner) warns against ALL deprecated security patterns: CAS, APTCA, .NET Remoting, DCOM, BinaryFormatter; crypto skill warns against deprecated crypto APIs (MD5, SHA1, DES, RC2)\n7. Cross-references validated per matrix above using grep-based checks (each `[skill:...]` ref verified)\n8. Security reviewer agent at `agents/dotnet-security-reviewer.md` with frontmatter (name, description, model, capabilities, tools), preloaded skills list, deterministic review workflow, and read-only constraints\n9. All 3 skills registered in `.claude-plugin/plugin.json` skills array\n10. Security reviewer agent registered in `.claude-plugin/plugin.json` agents array\n11. Cross-references to ASP.NET Core security documentation in relevant skills\n\n## Test Notes\n- Validate OWASP skill has a section for each of the 10 categories\n- Test cryptography skill provides version-gated guidance (net10.0 PQ vs earlier TFM fallback)\n- Verify secrets management skill covers local-dev vs production lifecycle\n- Confirm security reviewer agent follows existing agent pattern (see `agents/dotnet-architect.md`)\n- Confirm no overlap with auth/identity epics -- fn-8 references them, not duplicates\n\n## References\n- ASP.NET Core Security: https://learn.microsoft.com/en-us/aspnet/core/security/?view=aspnetcore-10.0\n- Secure Coding Guidelines: https://learn.microsoft.com/en-us/dotnet/standard/security/secure-coding-guidelines\n- Security in .NET: https://learn.microsoft.com/en-us/dotnet/standard/security/\n- OWASP Top 10 (2021): https://owasp.org/www-project-top-ten/\n- Post-Quantum Cryptography in .NET 10: https://learn.microsoft.com/en-us/dotnet/core/whats-new/dotnet-10/overview\n"
  },
  "epic_id": "fn-8-security-skills",
  "schema_version": 2,
  "tasks": [
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-11T22:31:58.015936Z",
        "depends_on": [],
        "epic": "fn-8-security-skills",
        "id": "fn-8-security-skills.1",
        "priority": null,
        "spec_path": ".flow/tasks/fn-8-security-skills.1.md",
        "status": "todo",
        "title": "OWASP and secrets management skills",
        "updated_at": "2026-02-12T20:53:26.436425Z"
      },
      "id": "fn-8-security-skills.1",
      "runtime": {
        "assignee": "claire@novotny.org",
        "claim_note": "",
        "claimed_at": "2026-02-12T20:56:55.824940Z",
        "evidence": {
          "commits": [
            "5a84e06",
            "d3b72da",
            "98e979f"
          ],
          "prs": [],
          "tests": [
            "grep -c OWASP categories (10/10)",
            "grep cross-references (all verified)",
            "grep deprecated patterns (CAS/APTCA/.NET Remoting/DCOM/BinaryFormatter)"
          ]
        },
        "status": "done",
        "updated_at": "2026-02-12T21:11:21.100942Z"
      },
      "spec": "# fn-8-security-skills.1 OWASP and secrets management skills\n\n## Description\nCreate the `dotnet-security-owasp` and `dotnet-secrets-management` skills at `skills/security/<name>/SKILL.md`.\n\n**dotnet-security-owasp:** Cover all 10 OWASP Top 10 (2021) categories with .NET-specific mitigation patterns. Each category gets a section with: vulnerability description, .NET-specific risk, mitigation code example, and gotchas. As the canonical owner of deprecated pattern warnings, include warnings for CAS, APTCA, .NET Remoting, DCOM, and BinaryFormatter.\n\n**dotnet-secrets-management:** Cloud-agnostic secrets guidance: user secrets for local development, environment variables for production, IConfiguration binding patterns, secret rotation guidance, managed identity mention as production best practice, anti-patterns (secrets in source/appsettings.json/hardcoded connection strings).\n\nBoth skills must follow the folder-per-skill convention with standard frontmatter (`name`, `description`), scope boundary, prerequisites, \u22652 code examples each, gotchas/pitfalls, cross-references per the epic matrix, and references including ASP.NET Core security documentation links.\n\n**File ownership (this task):**\n- `skills/security/dotnet-security-owasp/SKILL.md` (create)\n- `skills/security/dotnet-secrets-management/SKILL.md` (create)\n\n**Files NOT owned by this task (fn-8.2 owns):**\n- `skills/security/dotnet-cryptography/SKILL.md`\n- `agents/dotnet-security-reviewer.md`\n- `.claude-plugin/plugin.json` (final registration in fn-8.2)\n\n## Acceptance\n- [ ] `dotnet-security-owasp` skill at `skills/security/dotnet-security-owasp/SKILL.md` with frontmatter (`name`, `description`)\n- [ ] OWASP skill has sections for all 10 OWASP Top 10 (2021) categories (A01\u2013A10)\n- [ ] Each OWASP category has .NET-specific mitigation code example\n- [ ] OWASP skill warns against deprecated patterns: CAS, APTCA, .NET Remoting, DCOM, BinaryFormatter\n- [ ] OWASP skill includes ASP.NET Core security documentation links in references\n- [ ] `dotnet-secrets-management` skill at `skills/security/dotnet-secrets-management/SKILL.md` with frontmatter\n- [ ] Secrets skill covers: user secrets (local dev), environment variables (production), IConfiguration binding, secret rotation, managed identity mention\n- [ ] Secrets skill documents anti-patterns: secrets in source, appsettings.json, hardcoded connection strings\n- [ ] Secrets skill includes ASP.NET Core security documentation links in references\n- [ ] Both skills have: scope boundary, prerequisites, \u22652 code examples, gotchas/pitfalls, references\n- [ ] Cross-references verified by grep:\n  - `grep \"skill:dotnet-secrets-management\" skills/security/dotnet-security-owasp/SKILL.md` -- match\n  - `grep \"skill:dotnet-cryptography\" skills/security/dotnet-security-owasp/SKILL.md` -- match\n  - `grep \"skill:dotnet-csharp-coding-standards\" skills/security/dotnet-security-owasp/SKILL.md` -- match\n  - `grep \"skill:dotnet-security-owasp\" skills/security/dotnet-secrets-management/SKILL.md` -- match\n  - `grep \"skill:dotnet-csharp-configuration\" skills/security/dotnet-secrets-management/SKILL.md` -- match\n\n## Done summary\nCreated dotnet-security-owasp and dotnet-secrets-management skills covering all 10 OWASP Top 10 (2021) categories with .NET-specific mitigations, deprecated pattern warnings (CAS, APTCA, .NET Remoting, DCOM, BinaryFormatter), and comprehensive secrets lifecycle guidance (user secrets, environment variables, IConfiguration binding, rotation with IHostedService, managed identity, anti-patterns).\n## Evidence\n- Commits: 5a84e06, d3b72da, 98e979f\n- Tests: grep -c OWASP categories (10/10), grep cross-references (all verified), grep deprecated patterns (CAS/APTCA/.NET Remoting/DCOM/BinaryFormatter)\n- PRs:"
    },
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-11T22:31:58.135935Z",
        "depends_on": [
          "fn-8-security-skills.1"
        ],
        "epic": "fn-8-security-skills",
        "id": "fn-8-security-skills.2",
        "priority": null,
        "spec_path": ".flow/tasks/fn-8-security-skills.2.md",
        "status": "todo",
        "title": "Cryptography skill and security reviewer agent",
        "updated_at": "2026-02-12T20:53:42.881416Z"
      },
      "id": "fn-8-security-skills.2",
      "runtime": {
        "assignee": "claire@novotny.org",
        "claim_note": "",
        "claimed_at": "2026-02-12T21:15:30.748476Z",
        "evidence": {
          "commits": [],
          "prs": [],
          "tests": [
            "grep -c 'skills/security/' .claude-plugin/plugin.json returns 3",
            "grep -c 'dotnet-security-reviewer' .claude-plugin/plugin.json returns 1",
            "grep 'skill:dotnet-security-owasp' skills/security/dotnet-cryptography/SKILL.md -- match",
            "grep 'skill:dotnet-secrets-management' skills/security/dotnet-cryptography/SKILL.md -- match",
            "grep 'skill:dotnet-security-owasp' agents/dotnet-security-reviewer.md -- match",
            "grep 'skill:dotnet-secrets-management' agents/dotnet-security-reviewer.md -- match",
            "grep 'skill:dotnet-cryptography' agents/dotnet-security-reviewer.md -- match",
            "grep 'skill:dotnet-advisor' agents/dotnet-security-reviewer.md -- match"
          ]
        },
        "status": "done",
        "updated_at": "2026-02-12T21:20:04.392101Z"
      },
      "spec": "# fn-8-security-skills.2 Cryptography skill and security reviewer agent\n\n## Description\nCreate the `dotnet-cryptography` skill and `dotnet-security-reviewer` agent, then register all fn-8 deliverables in plugin.json.\n\n**Depends on:** fn-8-security-skills.1 (OWASP and secrets skills must exist before plugin registration and agent preload validation).\n\n**dotnet-cryptography:** Modern .NET cryptography covering hashing (SHA-256/384/512), symmetric encryption (AES-GCM), asymmetric (RSA, ECDSA), key derivation (PBKDF2, Argon2). Post-quantum algorithms (ML-KEM, ML-DSA, SLH-DSA) for .NET 10+ with TFM-aware guidance: what's available on net10.0 vs fallback for net8.0/net9.0. Include interoperability caveats. Warn against deprecated crypto APIs (MD5, SHA1, DES, RC2); cross-reference OWASP skill for the full deprecated security pattern list.\n\n**dotnet-security-reviewer:** Agent at `agents/dotnet-security-reviewer.md` following existing agent template (see `agents/dotnet-architect.md`). Must include: frontmatter (name, description, model, capabilities, tools), preloaded skills ([skill:dotnet-security-owasp], [skill:dotnet-secrets-management], [skill:dotnet-cryptography], [skill:dotnet-advisor]), deterministic review workflow, and read-only constraints (no code modification).\n\n**plugin.json registration:** Add all 3 security skills and the security reviewer agent to `.claude-plugin/plugin.json`. This is the final integration step \u2014 run after fn-8.1 skills exist.\n\n**File ownership (this task):**\n- `skills/security/dotnet-cryptography/SKILL.md` (create)\n- `agents/dotnet-security-reviewer.md` (create)\n- `.claude-plugin/plugin.json` (modify \u2014 add 3 skills + 1 agent)\n\n**Files NOT owned by this task (fn-8.1 owns):**\n- `skills/security/dotnet-security-owasp/SKILL.md`\n- `skills/security/dotnet-secrets-management/SKILL.md`\n\n## Acceptance\n- [ ] `dotnet-cryptography` skill at `skills/security/dotnet-cryptography/SKILL.md` with frontmatter (`name`, `description`)\n- [ ] Crypto skill covers: hashing, symmetric (AES-GCM), asymmetric (RSA, ECDSA), key derivation\n- [ ] Crypto skill has TFM-aware post-quantum section: ML-KEM, ML-DSA, SLH-DSA for net10.0+, fallback strategy for net8.0/net9.0\n- [ ] Crypto skill documents interoperability caveats for PQ algorithms\n- [ ] Crypto skill warns against deprecated crypto APIs (MD5, SHA1, DES, RC2) and cross-references OWASP for full deprecated pattern list\n- [ ] Crypto skill has: scope boundary, prerequisites, \u22652 code examples, gotchas/pitfalls, cross-references, references\n- [ ] Crypto skill includes ASP.NET Core security documentation links in references\n- [ ] Cross-references verified by grep:\n  - `grep \"skill:dotnet-security-owasp\" skills/security/dotnet-cryptography/SKILL.md` -- match\n  - `grep \"skill:dotnet-secrets-management\" skills/security/dotnet-cryptography/SKILL.md` -- match\n- [ ] `dotnet-security-reviewer` agent at `agents/dotnet-security-reviewer.md` with complete frontmatter (name, description, model, capabilities, tools)\n- [ ] Agent preloads verified by grep:\n  - `grep \"skill:dotnet-security-owasp\" agents/dotnet-security-reviewer.md` -- match\n  - `grep \"skill:dotnet-secrets-management\" agents/dotnet-security-reviewer.md` -- match\n  - `grep \"skill:dotnet-cryptography\" agents/dotnet-security-reviewer.md` -- match\n  - `grep \"skill:dotnet-advisor\" agents/dotnet-security-reviewer.md` -- match\n- [ ] Agent has deterministic review workflow and read-only constraints\n- [ ] Agent follows existing pattern from `agents/dotnet-architect.md`\n- [ ] 3 skills registered: `grep -c \"skills/security/\" .claude-plugin/plugin.json` returns 3\n- [ ] Agent registered: `grep -c \"dotnet-security-reviewer\" .claude-plugin/plugin.json` returns 1\n\n## Done summary\nCreated `dotnet-cryptography` skill covering hashing (SHA-2), symmetric encryption (AES-GCM), asymmetric crypto (RSA, ECDSA), key derivation (PBKDF2, Argon2), and post-quantum algorithms (ML-KEM, ML-DSA, SLH-DSA) with TFM-aware guidance for .NET 10+ vs net8.0/net9.0 fallback. Created `dotnet-security-reviewer` agent following the architect agent pattern with read-only constraints, deterministic workflow, and preloaded skills. Registered all 3 security skills and the agent in plugin.json.\n## Evidence\n- Commits:\n- Tests: grep -c 'skills/security/' .claude-plugin/plugin.json returns 3, grep -c 'dotnet-security-reviewer' .claude-plugin/plugin.json returns 1, grep 'skill:dotnet-security-owasp' skills/security/dotnet-cryptography/SKILL.md -- match, grep 'skill:dotnet-secrets-management' skills/security/dotnet-cryptography/SKILL.md -- match, grep 'skill:dotnet-security-owasp' agents/dotnet-security-reviewer.md -- match, grep 'skill:dotnet-secrets-management' agents/dotnet-security-reviewer.md -- match, grep 'skill:dotnet-cryptography' agents/dotnet-security-reviewer.md -- match, grep 'skill:dotnet-advisor' agents/dotnet-security-reviewer.md -- match\n- PRs:"
    }
  ]
}
