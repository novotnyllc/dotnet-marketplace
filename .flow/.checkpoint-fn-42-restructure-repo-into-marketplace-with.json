{
  "created_at": "2026-02-17T03:17:12.244381Z",
  "epic": {
    "data": {
      "branch_name": "fn-42-restructure-repo-into-marketplace-with",
      "created_at": "2026-02-17T02:39:11.331407Z",
      "depends_on_epics": [],
      "id": "fn-42-restructure-repo-into-marketplace-with",
      "next_task": 1,
      "plan_review_status": "unknown",
      "plan_reviewed_at": null,
      "spec_path": ".flow/specs/fn-42-restructure-repo-into-marketplace-with.md",
      "status": "open",
      "title": "Restructure Repo into Marketplace with Plugin Subdirectories",
      "updated_at": "2026-02-17T03:10:43.071751Z"
    },
    "spec": "# fn-42 Restructure Repo into Marketplace with Plugin Subdirectories\n\n## Overview\n\nRestructure `novotnyllc/dotnet-marketplace` from a flat single-plugin repo into a **marketplace** that hosts plugins in subdirectories, following the `anthropics/claude-plugins-official` pattern. Move the entire dotnet-artisan plugin into `plugins/dotnet-artisan/`. Clean up stale artifacts from completed epics. Remove the dist generation pipeline entirely \u2014 source files ARE the plugin.\n\nUsers install via:\n```\n/plugin marketplace add novotnyllc/dotnet-marketplace\n/plugin install dotnet-artisan\n```\n\n## Scope\n\n**In Scope:**\n- Delete stale files: fleet review docs, review reports, ralph run logs, dist/ pipeline (generate_dist.py, validate_cross_agent.py), dist/ output\n- Delete root `.claude-plugin/plugin.json` (replaced by marketplace.json)\n- Move all dotnet-artisan content to `plugins/dotnet-artisan/` with its own `.claude-plugin/plugin.json`\n- Move plugin-specific docs (`docs/hooks-and-mcp-guide.md`, `docs/dotnet-artisan-spec.md`) into plugin\n- Create root `.claude-plugin/marketplace.json` listing available plugins\n- Per-plugin versioning (tag format: `dotnet-artisan/v*`)\n- Update CI workflows for new structure (remove dist steps, per-plugin paths)\n- Add `.agents/openai.yaml` at repo root for Codex skill discovery\n- Add root marketplace.json validation to CI\n\n**Out of Scope:**\n- Copilot/Codex platform-specific output generation (future epic)\n- Adding additional plugins to the marketplace\n- MCP registry or Copilot plugin marketplace registration\n- Modifying any skill/agent content (purely structural)\n\n## Target Structure\n\n```\n/\n\u251c\u2500\u2500 .claude-plugin/\n\u2502   \u2514\u2500\u2500 marketplace.json              # Root: lists available plugins\n\u251c\u2500\u2500 plugins/\n\u2502   \u2514\u2500\u2500 dotnet-artisan/\n\u2502       \u251c\u2500\u2500 .claude-plugin/\n\u2502       \u2502   \u251c\u2500\u2500 plugin.json           # Per-plugin manifest (122 skills, 14 agents)\n\u2502       \u2502   \u2514\u2500\u2500 marketplace.json      # Per-plugin metadata (author, keywords, etc.)\n\u2502       \u251c\u2500\u2500 skills/                   # 122 skills (22 categories, unchanged internally)\n\u2502       \u251c\u2500\u2500 agents/                   # 14 specialist agents\n\u2502       \u251c\u2500\u2500 hooks/\n\u2502       \u2502   \u2514\u2500\u2500 hooks.json            # Session hooks (uses ${CLAUDE_PLUGIN_ROOT})\n\u2502       \u251c\u2500\u2500 scripts/\n\u2502       \u2502   \u251c\u2500\u2500 hooks/                # Hook shell scripts\n\u2502       \u2502   \u251c\u2500\u2500 validate-skills.sh\n\u2502       \u2502   \u251c\u2500\u2500 _validate_skills.py\n\u2502       \u2502   \u2514\u2500\u2500 validate-marketplace.sh\n\u2502       \u251c\u2500\u2500 tests/                    # Test suite (trigger-corpus.json, etc.)\n\u2502       \u251c\u2500\u2500 docs/                     # Plugin-specific docs\n\u2502       \u2502   \u251c\u2500\u2500 hooks-and-mcp-guide.md\n\u2502       \u2502   \u2514\u2500\u2500 dotnet-artisan-spec.md\n\u2502       \u251c\u2500\u2500 .mcp.json                 # MCP server config\n\u2502       \u251c\u2500\u2500 AGENTS.md                 # Skill routing + agent delegation\n\u2502       \u251c\u2500\u2500 CLAUDE.md                 # Plugin instructions\n\u2502       \u2514\u2500\u2500 CONTRIBUTING-SKILLS.md    # Skill authoring guide\n\u251c\u2500\u2500 .agents/\n\u2502   \u2514\u2500\u2500 openai.yaml                   # Codex skill discovery metadata\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/                    # CI (validate.yml, release.yml)\n\u251c\u2500\u2500 .flow/                            # Planning (stays at root)\n\u251c\u2500\u2500 scripts/\n\u2502   \u2514\u2500\u2500 ralph/                        # Dev tooling (stays at root, minus runs/)\n\u251c\u2500\u2500 README.md                         # Marketplace-level overview\n\u251c\u2500\u2500 CONTRIBUTING.md                   # Marketplace-level contribution guide\n\u251c\u2500\u2500 CHANGELOG.md\n\u2514\u2500\u2500 LICENSE\n```\n\n## Design Decisions\n\n1. **Marketplace pattern**: Follow `anthropics/claude-plugins-official` \u2014 root `marketplace.json` with `\"source\": \"./plugins/dotnet-artisan\"`, each plugin has own `.claude-plugin/plugin.json`. This is the officially supported multi-plugin pattern (7,525 stars, actively maintained).\n\n2. **No dist pipeline**: Source files ARE the final output. Claude Code reads directly from the plugin directory. No generation, no transformation, no build step for developers.\n\n3. **Hooks use `${CLAUDE_PLUGIN_ROOT}`**: Already platform-relative. When installed, `CLAUDE_PLUGIN_ROOT` resolves to the plugin's cached location. No path changes needed inside hooks.json or hook scripts.\n\n4. **Per-plugin versioning**: Version in `plugins/dotnet-artisan/.claude-plugin/plugin.json`. Tag format: `dotnet-artisan/v0.1.0`. Release workflow scoped to plugin-prefixed tags.\n\n5. **Skill paths unchanged inside plugin**: All paths in plugin.json are relative to the plugin root. Moving the plugin to a subdirectory doesn't change any internal references \u2014 `skills/foundation/dotnet-advisor` stays the same.\n\n6. **Root plugin.json deleted**: The old root `.claude-plugin/plugin.json` is deleted entirely. Only `marketplace.json` remains at root to prevent ambiguous plugin discovery.\n\n7. **Dev tooling stays at root**: `scripts/ralph/` (minus `runs/`) stays at repo root since it's repo-level dev tooling, not plugin content. `.flow/` stays at root.\n\n8. **Feature branch workflow**: All tasks happen on a feature branch. Intermediate CI breakage is acceptable \u2014 only the final PR merge must pass.\n\n## Quick commands\n\n```bash\n# From plugin directory\ncd plugins/dotnet-artisan\n./scripts/validate-skills.sh\n./scripts/validate-marketplace.sh\n# Root marketplace validation\njq empty .claude-plugin/marketplace.json\n```\n\n## Acceptance\n\n- [ ] `plugins/dotnet-artisan/` contains the complete plugin (122 skills, 14 agents, hooks, scripts, .mcp.json)\n- [ ] Root `.claude-plugin/marketplace.json` lists dotnet-artisan with `\"source\": \"./plugins/dotnet-artisan\"`\n- [ ] Root `.claude-plugin/plugin.json` is DELETED (no ambiguous discovery)\n- [ ] `plugins/dotnet-artisan/.claude-plugin/plugin.json` has all skill/agent/hook/mcp paths (relative to plugin root, unchanged)\n- [ ] `plugins/dotnet-artisan/.claude-plugin/marketplace.json` has plugin metadata (author, keywords, categories)\n- [ ] Per-plugin version in plugin manifest; release workflow uses `dotnet-artisan/v*` tag pattern\n- [ ] Stale files deleted: `docs/fleet-review-rubric.md`, `docs/review-reports/`, `scripts/ralph/runs/`, `dist/`, `scripts/generate_dist.py`, `scripts/validate_cross_agent.py`\n- [ ] `.gitignore` updated (no `dist/` entry)\n- [ ] CI `validate.yml` validates root marketplace.json AND runs plugin validation from subdirectory, no dist steps\n- [ ] CI `release.yml` uses per-plugin tags, no Pages deployment\n- [ ] `.agents/openai.yaml` exists at repo root with valid Codex metadata\n- [ ] Hooks work correctly with `${CLAUDE_PLUGIN_ROOT}` from the subdirectory location\n- [ ] Plugin-specific docs moved: `docs/hooks-and-mcp-guide.md`, `docs/dotnet-artisan-spec.md` \u2192 `plugins/dotnet-artisan/docs/`\n\n## References\n\n- `anthropics/claude-plugins-official` marketplace pattern: root `marketplace.json` \u2192 `./plugins/<name>/`\n- `trailofbits/skills-curated` uses same `plugins/` + per-plugin `.claude-plugin/` pattern\n- Codex openai.yaml schema: `.agents/openai.yaml` at repo root\n- Agent Skills spec: https://agentskills.io/specification\n"
  },
  "epic_id": "fn-42-restructure-repo-into-marketplace-with",
  "schema_version": 2,
  "tasks": [
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-17T02:40:12.336114Z",
        "depends_on": [],
        "epic": "fn-42-restructure-repo-into-marketplace-with",
        "id": "fn-42-restructure-repo-into-marketplace-with.1",
        "priority": null,
        "spec_path": ".flow/tasks/fn-42-restructure-repo-into-marketplace-with.1.md",
        "status": "todo",
        "title": "Clean up stale files and remove dist pipeline",
        "updated_at": "2026-02-17T03:10:59.846247Z"
      },
      "id": "fn-42-restructure-repo-into-marketplace-with.1",
      "runtime": null,
      "spec": "# fn-42-restructure-repo-into-marketplace-with.1 Clean up stale files and remove dist pipeline\n\n## Description\nDelete stale artifacts from completed work and remove the dist generation pipeline entirely. Also delete the root plugin.json to prevent ambiguous plugin discovery.\n\n**Size:** S\n**Files:** Various deletions, `.gitignore`, `.claude-plugin/plugin.json` (delete)\n\n## Approach\n\n- **Root plugin.json**: Delete `.claude-plugin/plugin.json` (will be replaced by marketplace.json in Task .2). This prevents Claude Code from loading a broken standalone plugin at root level.\n- **Fleet review artifacts**: Delete `docs/fleet-review-rubric.md` and `docs/review-reports/` (historical snapshots from completed fn-29/fn-40 epics)\n- **Ralph execution logs**: Delete `scripts/ralph/runs/` only. Keep `scripts/ralph/` itself (config.env, ralph.sh, etc.) at repo root \u2014 it is repo-level dev tooling, not plugin content.\n- **Dist pipeline scripts**: Delete `scripts/generate_dist.py` and `scripts/validate_cross_agent.py`\n- **Dist output**: Delete the `dist/` directory entirely. Remove the `dist/` entry from `.gitignore`.\n- **Python cache**: Delete `scripts/__pycache__/` if present.\n\n## Key Context\n\n- `generate_dist.py` generated dist/claude/, dist/copilot/, dist/codex/ from source\n- `validate_cross_agent.py` validated the generated outputs\n- Both are referenced in CI workflows \u2014 those references are updated in Task .3\n- Cross-ref `[skill:name]` validation already exists in `_validate_skills.py` (lines 130-131, 293-305) \u2014 no extraction needed\n- Deleting root plugin.json is safe because Task .2 creates the replacement marketplace.json before any CI runs on main\n## Approach\n\n- **Fleet review artifacts**: Delete `docs/fleet-review-rubric.md` and `docs/review-reports/` (historical snapshots from completed fn-29/fn-40 epics)\n- **Ralph execution logs**: Delete `scripts/ralph/runs/` (~107 MB of completed execution logs). Keep `scripts/ralph/` itself if it contains config/scripts, just the runs.\n- **Dist pipeline**: Delete `scripts/generate_dist.py` and `scripts/validate_cross_agent.py`. These produced `dist/` output for Claude/Copilot/Codex \u2014 no longer needed since source files ARE the plugin.\n- **Dist output**: Delete any committed files under `dist/` (should already be gitignored, verify). Remove the `dist/` entry from `.gitignore` since there's no dist anymore.\n- **Completed flow epics**: Optionally clean up `.flow/` files for completed epics fn-29 and fn-40 (both marked \"done\"). These are small metadata files \u2014 low priority.\n- **Python cache**: Delete `scripts/__pycache__/` if present.\n\n## Key Context\n\n- `generate_dist.py` (21 KB) generated dist/claude/, dist/copilot/, dist/codex/ from source\n- `validate_cross_agent.py` (42 KB) validated the generated outputs\n- Both are referenced in CI workflows \u2014 those references will be updated in Task .3\n- Cross-ref `[skill:name]` validation was embedded in generate_dist.py \u2014 will be extracted in Task .2\n\n## Acceptance\n- [ ] `.claude-plugin/plugin.json` at root is deleted\n- [ ] `docs/fleet-review-rubric.md` and `docs/review-reports/` deleted\n- [ ] `scripts/ralph/runs/` deleted; `scripts/ralph/` (config, scripts) preserved\n- [ ] `scripts/generate_dist.py` and `scripts/validate_cross_agent.py` deleted\n- [ ] `dist/` directory deleted; `dist/` entry removed from `.gitignore`\n- [ ] `scripts/__pycache__/` cleaned if present\n- [ ] No broken imports or references to deleted files in remaining code\n## Done summary\nTBD\n\n## Evidence\n- Commits:\n- Tests:\n- PRs:\n"
    },
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-17T02:40:12.434516Z",
        "depends_on": [
          "fn-42-restructure-repo-into-marketplace-with.1"
        ],
        "epic": "fn-42-restructure-repo-into-marketplace-with",
        "id": "fn-42-restructure-repo-into-marketplace-with.2",
        "priority": null,
        "spec_path": ".flow/tasks/fn-42-restructure-repo-into-marketplace-with.2.md",
        "status": "todo",
        "title": "Restructure into marketplace with plugin subdirectory",
        "updated_at": "2026-02-17T03:11:31.035528Z"
      },
      "id": "fn-42-restructure-repo-into-marketplace-with.2",
      "runtime": null,
      "spec": "# fn-42-restructure-repo-into-marketplace-with.2 Restructure into marketplace with plugin subdirectory\n\n## Description\nMove all dotnet-artisan plugin content into `plugins/dotnet-artisan/`. Create the root marketplace structure. Update all documentation and validation scripts.\n\n**Size:** M\n**Files:** Entire repo structure, `.claude-plugin/marketplace.json` (root), `plugins/dotnet-artisan/.claude-plugin/plugin.json`, `plugins/dotnet-artisan/.claude-plugin/marketplace.json`, docs, validation scripts\n\n## Approach\n\n### File Moves (git mv for history preservation)\n\nMove INTO `plugins/dotnet-artisan/`:\n- `skills/` (all 22 categories, 122 skills)\n- `agents/` (14 specialist agents)\n- `hooks/` (hooks.json)\n- `scripts/hooks/` (post-edit-dotnet.sh, session-start-context.sh)\n- `scripts/validate-skills.sh`, `scripts/_validate_skills.py`, `scripts/validate-marketplace.sh`\n- `.mcp.json`\n- `tests/`\n- `AGENTS.md` (skill routing + agent delegation)\n- `CONTRIBUTING-SKILLS.md`\n- `docs/hooks-and-mcp-guide.md` \u2192 `plugins/dotnet-artisan/docs/`\n- `docs/dotnet-artisan-spec.md` \u2192 `plugins/dotnet-artisan/docs/`\n\n**Important**: Use `git mv` for each move to preserve file history. Do all moves before modifying content to keep git tracking renames cleanly.\n\n### Manifest Changes\n\n**Root `.claude-plugin/marketplace.json`** (NEW \u2014 marketplace listing):\nFollow the `anthropics/claude-plugins-official` pattern. Contains marketplace name, owner, and plugins array with source paths.\n\n**`plugins/dotnet-artisan/.claude-plugin/plugin.json`** (MOVED \u2014 paths unchanged):\nAll skill, agent, hook, and MCP paths are relative to the plugin root. Since the internal structure stays the same, NO path changes needed inside plugin.json.\n\n**`plugins/dotnet-artisan/.claude-plugin/marketplace.json`** (MOVED \u2014 per-plugin metadata):\nThe existing marketplace.json (author, keywords, categories) moves here as per-plugin metadata.\n\n### Documentation Updates\n\n**Root `README.md`**: Rewrite as marketplace overview \u2014 what plugins are available, how to install, link to plugin READMEs.\n\n**`plugins/dotnet-artisan/README.md`**: Move current root README.md content here (skill catalog, architecture, installation). Update path references.\n\n**Root `CLAUDE.md`**: Rewrite as minimal marketplace instructions. Point to plugin subdirectories for plugin-specific instructions.\n\n**`plugins/dotnet-artisan/CLAUDE.md`**: Move current CLAUDE.md here. Update file paths in \"File Structure\" and \"Validation Commands\" sections.\n\n**Root `CONTRIBUTING.md`**: Keep at root. Update to remove dist generation references. Point to plugin-specific CONTRIBUTING-SKILLS.md.\n\n### Validation Scripts\n\nMove `validate-skills.sh`, `_validate_skills.py`, `validate-marketplace.sh` into `plugins/dotnet-artisan/scripts/`. They use `$(dirname \"$0\")/..` for REPO_ROOT \u2014 after the move, this resolves to the plugin root, which is correct.\n\n**No cross-ref extraction needed**: `_validate_skills.py` already validates `[skill:name]` cross-references (lines 130-131, 293-305).\n\n**Root marketplace.json validation**: Update `validate-marketplace.sh` to also validate root-level marketplace.json schema (plugins array, source paths resolve), OR add a root-level check in CI directly.\n\n### What Does NOT Change\n\n- Internal skill/agent/hook content (SKILL.md files, agent .md files, hook scripts)\n- Plugin.json skill/agent path arrays (already relative to plugin root)\n- Hook `${CLAUDE_PLUGIN_ROOT}` references\n- `.mcp.json` content (context7 MCP servers)\n- `tests/trigger-corpus.json` content (paths are relative to skills/ within the plugin)\n\n## Key Context\n\n- `anthropics/claude-plugins-official` is the canonical pattern: `plugins/{name}/.claude-plugin/plugin.json`\n- Claude Code caches the plugin directory \u2014 all files must be self-contained within it\n- `CLAUDE_PLUGIN_ROOT` is set at install time \u2014 resolves to the plugin cached location\n- `validate-skills.sh` line 32: `REPO_ROOT=$(cd \"$(dirname \"$0\")/..\" && pwd)` \u2014 after move, this = plugin root\n- `_validate_skills.py` line 233: `skills_dir = repo_root / \"skills\"` \u2014 works since skills/ is inside plugin root\n## Approach\n\n### File Moves (git mv for history preservation)\n\nMove INTO `plugins/dotnet-artisan/`:\n- `skills/` (all 22 categories, 121 skills)\n- `agents/` (14 specialist agents)\n- `hooks/` (hooks.json)\n- `scripts/hooks/` (post-edit-dotnet.sh, session-start-context.sh)\n- `scripts/validate-skills.sh`, `scripts/_validate_skills.py`, `scripts/validate-marketplace.sh`\n- `.mcp.json`\n- `tests/`\n- `AGENTS.md` (skill routing + agent delegation)\n- `CONTRIBUTING-SKILLS.md`\n\n### Manifest Changes\n\n**Root `.claude-plugin/marketplace.json`** (NEW \u2014 marketplace listing):\n```json\n{\n  \"name\": \"novotnyllc-dotnet-marketplace\",\n  \"description\": \"Marketplace for .NET development plugins\",\n  \"author\": {\n    \"name\": \"Claire Novotny LLC\",\n    \"url\": \"https://github.com/novotnyllc\"\n  },\n  \"repository\": \"https://github.com/novotnyllc/dotnet-marketplace\",\n  \"license\": \"MIT\",\n  \"metadata\": {\n    \"pluginRoot\": \"./plugins\"\n  },\n  \"plugins\": [\n    {\n      \"name\": \"dotnet-artisan\",\n      \"source\": \"./plugins/dotnet-artisan\",\n      \"description\": \"Comprehensive .NET development skills for modern C#, ASP.NET, MAUI, Blazor, and cloud-native applications\"\n    }\n  ]\n}\n```\n\n**`plugins/dotnet-artisan/.claude-plugin/plugin.json`** (MOVED \u2014 paths unchanged):\nAll skill, agent, hook, and MCP paths are relative to the plugin root. Since the internal structure stays the same, NO path changes are needed. The `hooks` field references `hooks/hooks.json`, which in turn uses `${CLAUDE_PLUGIN_ROOT}/scripts/hooks/...` \u2014 all self-relative.\n\n**`plugins/dotnet-artisan/.claude-plugin/marketplace.json`** (MOVED \u2014 per-plugin metadata):\nThe existing marketplace.json (author, keywords, categories) moves here. This becomes the per-plugin metadata.\n\n### Documentation Splits\n\n**Root `README.md`**: Marketplace overview \u2014 what plugins are available, how to install (`/plugin marketplace add novotnyllc/dotnet-marketplace`), link to each plugin's README.\n\n**`plugins/dotnet-artisan/README.md`**: Move current root README.md content here (skill catalog, architecture, installation).\n\n**Root `CLAUDE.md`**: Minimal \u2014 marketplace-level instructions, point to plugin subdirectories.\n\n**`plugins/dotnet-artisan/CLAUDE.md`**: Move current CLAUDE.md here. Update file paths in the \"File Structure\" and \"Validation Commands\" sections to reflect the new location.\n\n**Root `CONTRIBUTING.md`**: Keep at root, update references.\n\n### Validation Scripts\n\nMove `validate-skills.sh`, `_validate_skills.py`, `validate-marketplace.sh` into `plugins/dotnet-artisan/scripts/`. They already work relative to the plugin directory structure. Update any hardcoded paths.\n\n**Cross-ref validation**: Extract `[skill:name]` cross-reference validation from the deleted `generate_dist.py` and add it to `_validate_skills.py`. This check verifies that every `[skill:name]` reference points to an actual skill directory.\n\n### What Does NOT Change\n\n- Internal skill/agent/hook content (SKILL.md files, agent .md files, hook scripts)\n- Plugin.json skill/agent path arrays (already relative to plugin root)\n- Hook `${CLAUDE_PLUGIN_ROOT}` references\n- `.mcp.json` content (context7 MCP servers)\n\n## Key Context\n\n- `anthropics/claude-code` is the reference pattern: root marketplace.json with `\"source\": \"./plugins/<name>/\"`\n- Claude Code caches the plugin directory \u2014 all files must be self-contained within it\n- `npx skills add novotnyllc/dotnet-marketplace/plugins/dotnet-artisan` supports subdirectory paths\n- Git mv preserves file history for blame/log\n- CLAUDE_PLUGIN_ROOT is set by Claude Code at install time \u2014 always resolves to the plugin's cached location\n\n## Acceptance\n- [ ] `plugins/dotnet-artisan/` contains: skills/ (122), agents/ (14), hooks/, scripts/, tests/, docs/, .mcp.json\n- [ ] Root `.claude-plugin/marketplace.json` lists dotnet-artisan with `\"source\": \"./plugins/dotnet-artisan\"`\n- [ ] `plugins/dotnet-artisan/.claude-plugin/plugin.json` present with unchanged internal paths\n- [ ] `plugins/dotnet-artisan/.claude-plugin/marketplace.json` has per-plugin metadata\n- [ ] Root README.md is marketplace-level; plugin README.md has skill catalog\n- [ ] Root CLAUDE.md is minimal marketplace instructions; plugin CLAUDE.md has plugin instructions\n- [ ] `plugins/dotnet-artisan/AGENTS.md` has skill routing and agent delegation\n- [ ] Plugin docs moved: `plugins/dotnet-artisan/docs/hooks-and-mcp-guide.md`, `plugins/dotnet-artisan/docs/dotnet-artisan-spec.md`\n- [ ] Validation scripts work from plugin directory: `cd plugins/dotnet-artisan && ./scripts/validate-skills.sh && ./scripts/validate-marketplace.sh`\n- [ ] No root-level orphaned files from the plugin (skills/, agents/, hooks/, .mcp.json etc. removed from root)\n- [ ] Empty `docs/` directory at root removed (if no files remain)\n## Done summary\nTBD\n\n## Evidence\n- Commits:\n- Tests:\n- PRs:\n"
    },
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-17T02:40:12.535269Z",
        "depends_on": [
          "fn-42-restructure-repo-into-marketplace-with.2"
        ],
        "epic": "fn-42-restructure-repo-into-marketplace-with",
        "id": "fn-42-restructure-repo-into-marketplace-with.3",
        "priority": null,
        "spec_path": ".flow/tasks/fn-42-restructure-repo-into-marketplace-with.3.md",
        "status": "todo",
        "title": "Update CI workflows and per-plugin versioning",
        "updated_at": "2026-02-17T03:11:48.428037Z"
      },
      "id": "fn-42-restructure-repo-into-marketplace-with.3",
      "runtime": null,
      "spec": "# fn-42-restructure-repo-into-marketplace-with.3 Update CI workflows and per-plugin versioning\n\n## Description\nUpdate GitHub Actions workflows for the new marketplace structure. Remove dist generation steps. Implement per-plugin versioning with plugin-prefixed tags. Add root marketplace.json validation.\n\n**Size:** S\n**Files:** `.github/workflows/validate.yml`, `.github/workflows/release.yml`\n\n## Approach\n\n### validate.yml\n\n- **JSON validation step**: Validate root `.claude-plugin/marketplace.json` AND plugin-level files: `plugins/dotnet-artisan/.claude-plugin/plugin.json`, `plugins/dotnet-artisan/.claude-plugin/marketplace.json`, `plugins/dotnet-artisan/hooks/hooks.json`, `plugins/dotnet-artisan/.mcp.json`\n- **Root marketplace.json validation**: Check that each plugin in the `plugins[]` array has a valid `source` path pointing to a directory containing `.claude-plugin/plugin.json`\n- **Validate skills step**: `cd plugins/dotnet-artisan && ./scripts/validate-skills.sh`\n- **Validate marketplace step**: `cd plugins/dotnet-artisan && ./scripts/validate-marketplace.sh`\n- **Remove** \"Generate dist/ outputs\" and \"Validate cross-agent conformance\" steps entirely\n- **Job summary**: Keep description budget metrics, remove dist-related metrics\n\n### release.yml\n\n- **Trigger**: Change from `v*` to `dotnet-artisan/v*` tags\n- **Version extraction**: Parse version from `dotnet-artisan/v0.1.0` format\n- **Remove Pages deployment**: Drop `configure-pages`, `upload-pages-artifact`, `deploy-pages` steps and `pages` concurrency group\n- **Remove permissions**: Drop `pages: write` and `id-token: write`\n- **Release body**: Update to reference plugin install command, not dist URLs\n- **Validation**: Run from plugin directory (same as validate.yml)\n\n### Per-plugin versioning\n\n- Version source of truth: `plugins/dotnet-artisan/.claude-plugin/plugin.json` `version` field\n- Tag format: `dotnet-artisan/v0.1.0`\n- GitHub Release name: `dotnet-artisan v0.1.0`\n\n## Key Context\n\n- Current validate.yml at `.github/workflows/validate.yml:1-72`\n- Current release.yml at `.github/workflows/release.yml:1-97`\n- Both currently reference generate_dist.py and validate_cross_agent.py (deleted in Task .1)\n- Work happens on feature branch \u2014 intermediate CI failures on the branch are OK\n## Approach\n\n### validate.yml\n\n- **JSON validation step**: Update paths \u2014 `plugins/dotnet-artisan/.claude-plugin/plugin.json`, `plugins/dotnet-artisan/.claude-plugin/marketplace.json`, `plugins/dotnet-artisan/hooks/hooks.json`, `plugins/dotnet-artisan/.mcp.json`. Also validate root `.claude-plugin/marketplace.json`.\n- **Validate skills step**: Run from plugin directory: `cd plugins/dotnet-artisan && ./scripts/validate-skills.sh`\n- **Validate marketplace step**: Run from plugin directory: `cd plugins/dotnet-artisan && ./scripts/validate-marketplace.sh`\n- **Remove \"Generate dist/ outputs\" step**: No more `python3 scripts/generate_dist.py --strict`\n- **Remove \"Validate cross-agent conformance\" step**: No more `python3 scripts/validate_cross_agent.py`\n- **Job summary**: Keep the description budget metrics, remove dist-related metrics\n\n### release.yml\n\n- **Trigger**: Change from `v*` tags to `dotnet-artisan/v*` tags:\n  ```yaml\n  on:\n    push:\n      tags:\n        - 'dotnet-artisan/v*'\n  ```\n- **Version extraction**: Parse version from `dotnet-artisan/v0.1.0` format\n- **Remove Pages deployment**: No more `dist/` to deploy. Remove `configure-pages`, `upload-pages-artifact`, `deploy-pages` steps and `pages` concurrency group.\n- **Remove permissions**: Drop `pages: write` and `id-token: write` (only needed for Pages)\n- **Release body**: Update to reflect plugin-specific release (not cross-agent dist). Reference plugin install command.\n- **Validation**: Run from plugin directory (same as validate.yml)\n\n### Per-plugin versioning\n\n- Version source of truth: `plugins/dotnet-artisan/.claude-plugin/plugin.json` `version` field\n- Tag format: `dotnet-artisan/v0.1.0`\n- GitHub Release name: `dotnet-artisan v0.1.0`\n- Future plugins get their own tag prefix and release workflow (or a matrix workflow)\n\n## Key Context\n\n- Current validate.yml at `.github/workflows/validate.yml:1-72`\n- Current release.yml at `.github/workflows/release.yml:1-97`\n- Both currently run generate_dist.py and validate_cross_agent.py \u2014 both being deleted in Task .1\n- Pages deployment served dist/ \u2014 no longer applicable\n\n## Acceptance\n- [ ] validate.yml validates root marketplace.json (JSON valid + source paths resolve)\n- [ ] validate.yml validates plugin-level JSON files at new paths\n- [ ] validate.yml runs skill and marketplace validation from `plugins/dotnet-artisan/`\n- [ ] validate.yml has no references to generate_dist.py or validate_cross_agent.py\n- [ ] release.yml triggers on `dotnet-artisan/v*` tags\n- [ ] release.yml has no Pages deployment steps or pages permissions\n- [ ] release.yml creates GitHub Release with plugin install instructions in body\n- [ ] Both workflows pass on the restructured branch\n## Done summary\nTBD\n\n## Evidence\n- Commits:\n- Tests:\n- PRs:\n"
    },
    {
      "data": {
        "assignee": null,
        "claim_note": "",
        "claimed_at": null,
        "created_at": "2026-02-17T02:40:12.635437Z",
        "depends_on": [],
        "epic": "fn-42-restructure-repo-into-marketplace-with",
        "id": "fn-42-restructure-repo-into-marketplace-with.4",
        "priority": null,
        "spec_path": ".flow/tasks/fn-42-restructure-repo-into-marketplace-with.4.md",
        "status": "todo",
        "title": "Add .agents/openai.yaml for Codex discovery",
        "updated_at": "2026-02-17T03:11:59.367572Z"
      },
      "id": "fn-42-restructure-repo-into-marketplace-with.4",
      "runtime": null,
      "spec": "# fn-42-restructure-repo-into-marketplace-with.4 Add .agents/openai.yaml for Codex discovery\n\n## Description\nCreate `.agents/openai.yaml` at the repo root so Codex can discover the plugin metadata. Minimal file \u2014 interface (display name, description) and policy fields.\n\n**Size:** S\n**Files:** `.agents/openai.yaml`\n\n## Approach\n\n- Create `.agents/openai.yaml` at the repo root with:\n  - `interface.display_name`: \"dotnet-artisan\"\n  - `interface.short_description`: the plugin description\n  - `policy.allow_implicit_invocation`: true\n- Verify the Codex openai.yaml schema before authoring \u2014 if the schema has changed or the URL is unavailable, use the pattern from existing repos (e.g., `anthropics/claude-plugins-official`)\n- This file is hand-authored and committed \u2014 no generation needed\n\n## Key Context\n\n- Codex reads `.agents/` at the repo root for skill discovery\n- The skills themselves live at `plugins/dotnet-artisan/skills/` \u2014 the openai.yaml provides top-level metadata only\n- This does NOT require moving or duplicating skills to `.agents/skills/`\n- This task has no dependencies and can be done in parallel with other tasks\n## Approach\n\n- Create `.agents/openai.yaml` at the repo root with:\n  - `interface.display_name`: \"dotnet-artisan\" (from plugin marketplace.json)\n  - `interface.short_description`: the plugin description\n  - `policy.allow_implicit_invocation`: true\n- Reference the Codex openai.yaml schema at https://developers.openai.com/codex/skills/ for exact field names and any additional required/optional fields\n- This file is hand-authored and committed \u2014 no generation needed\n\n## Key Context\n\n- Codex's `$skill-installer` reads `.agents/` at the repo root\n- `npx skills add` also reads `.agents/skills/` as a universal agent directory\n- The skills themselves live at `plugins/dotnet-artisan/skills/` \u2014 the openai.yaml just provides top-level metadata for Codex to display\n- This does NOT require moving or duplicating skills to `.agents/skills/` \u2014 `npx skills add` supports subdirectory paths to find them at `plugins/dotnet-artisan/`\n\n## Acceptance\n- [ ] `.agents/openai.yaml` exists at repo root\n- [ ] Contains valid YAML with `interface` and `policy` keys\n- [ ] Display name and description match plugin metadata\n## Done summary\nTBD\n\n## Evidence\n- Commits:\n- Tests:\n- PRs:\n"
    }
  ]
}
