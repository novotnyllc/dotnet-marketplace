skill_name: dotnet-observability

test_prompts:
  - "Add full OpenTelemetry observability to an ASP.NET Core API: traces for HTTP requests and custom operations, metrics for business KPIs (orders processed, revenue), structured logging with trace correlation, and separate liveness/readiness health check endpoints."
  - "How do I create custom metrics in .NET using System.Diagnostics.Metrics with IMeterFactory and export them via OpenTelemetry OTLP? Show the counter, histogram, and gauge patterns with proper DI registration."

criteria:
  - name: otel_setup
    weight: 0.30
    description: "Configures OpenTelemetry via AddOpenTelemetry with ConfigureResource, WithTracing, and WithMetrics. Adds AspNetCore and HttpClient instrumentation. Registers custom ActivitySource names with AddSource and custom Meter names with AddMeter. Uses AddOtlpExporter for export. Configures via OTEL_EXPORTER_OTLP_ENDPOINT environment variables, not hardcoded endpoints."
  - name: custom_metrics
    weight: 0.25
    description: "Creates Meter instances via IMeterFactory from DI, not via new Meter(). Defines Counter<T> for event counts, Histogram<T> for distributions (request durations, order values), and ObservableGauge<T> for current-state values. Follows OpenTelemetry semantic conventions for metric names."
  - name: structured_logging
    weight: 0.20
    description: "Uses structured logging templates with {Placeholder} syntax, never string concatenation or interpolation in log calls. Uses source-generated LoggerMessage for hot paths (zero allocation). Enriches logs with TraceId and SpanId for log-to-trace correlation."
  - name: health_checks
    weight: 0.15
    description: "Separates liveness from readiness endpoints (/health/live and /health/ready) with tag-based filtering. Liveness checks do not include dependency health (only self-check). Readiness checks include database, message broker, and external service health. Uses AddHealthChecks with typed checks and tags."
  - name: aspire_awareness
    weight: 0.10
    description: "Acknowledges that .NET Aspire ServiceDefaults configures OpenTelemetry automatically and should not be duplicated. For non-Aspire apps, provides explicit configuration. Understands runtime instrumentation (GC, thread pool) via AddRuntimeInstrumentation."
